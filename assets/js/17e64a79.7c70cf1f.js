"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8367],{168:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/Python website (for 64bit windows)-a97225e112c62ec19e7974ea39cb52e0.webp"},546:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/NVIDIA GeForce \u2014 check for driver updates-e267a887a3cba3bc3df301121d5562c8.webp"},2562:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>d,frontMatter:()=>a,metadata:()=>t,toc:()=>c});var t=i(7355),s=i(4848),o=i(8453);const a={slug:"tf-minimal",title:"How to use TensorFlow with GPU on Windows for minimal tasks\u2014 in the most simple way(2024)",authors:["ajay"],tags:["tensorflow","gpu"]},r=void 0,l={authorsImageUrls:[void 0]},c=[{value:"TensorFlow GPU access steps overview:",id:"tensorflow-gpu-access-steps-overview",level:2},{value:"Things to do before the real installation",id:"things-to-do-before-the-real-installation",level:2},{value:"Real change-makers",id:"real-change-makers",level:2}];function h(e){const n={a:"a",code:"code",em:"em",h2:"h2",hr:"hr",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["Read on ",(0,s.jsx)(n.a,{href:"https://medium.com/@ajaytshaju/how-to-use-gpu-with-tensorflow-on-windows-b1726a28ab3d",children:"Medium"})]}),"\n",(0,s.jsx)(n.p,{children:"Accelerating machine learning code using your system\u2019s GPU will make the code run much faster and save a lot of time. In this blog we are going to do a quick setup to make TensorFlow access our PC/Laptop\u2019s GPU, just like installing 3\u20134 libraries in python using pip."}),"\n",(0,s.jsx)(n.p,{children:"Be informed:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The latest TensorFlow version is 2.16 (As of March 2024), but TensorFlow can access GPU only if its version is ",(0,s.jsx)(n.code,{children:"<= 2.10"})," in Windows. So if your code is written in the latest version you might need to fix the syntax and function calls."]}),"\n",(0,s.jsx)(n.li,{children:"Some commands given in this tutorial may install big libraries which are gigabytes in size so be careful about your internet."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"tensorflow-gpu-access-steps-overview",children:"TensorFlow GPU access steps overview:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Install Python 3.10.11"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Update CUDA Driver to the latest version"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Install TensorFlow-CPU 2.10"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Install tensorflow-directml-plugin"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run a sample code"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.p,{children:"Good to know:"}),"\n",(0,s.jsx)(n.p,{children:"You can install Python libraries for the user(may result in package version conflicts, if you have multiple projects) or in a virtual environment(more recommended). I recommend you first try the installation on a virtual environment(venv) and if it works, then you can activate and use that venv interpreter whenever you need to run a code on GPU."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"I am explaining the installation procedure using venv"})}),"\n",(0,s.jsx)(n.h2,{id:"things-to-do-before-the-real-installation",children:"Things to do before the real installation"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Make a virtual environment and activate it (",(0,s.jsx)(n.a,{href:"https://medium.com/@ajaytshaju/how-to-make-a-virtual-environment-in-python-windows-17a30b67d3bc",children:"see this tutorial"}),")."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Open your command prompt, type ",(0,s.jsx)(n.code,{children:"nvidia-smi"})," and hit enter (will need this later). If you get an error, then make sure you have a dedicated GPU and your device can find that device (checking \u2014 Start \u2192 device manager \u2192 display adapters \u2192 name of your graphics card)"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.img,{alt:"nvidia-smi command output",src:i(7914).A+"",width:"1121",height:"666"}),"\nnvidia-smi command output"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Install PyTorch(for getting necessary CUDA & cuDNN libraries easily):"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Search ",(0,s.jsx)(n.code,{children:"PyTorch Start Locally"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Give details like PyTorch Build, Your OS, Package(pip, conda), Language, Compute Platform(select CUDA as seen on nvidia-smi), Run the resultant command on your command prompt (see the image below)."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.img,{alt:"PyTorch Start Locally",src:i(7196).A+"",width:"1057",height:"416"}),"\nPyTorch Start Locally"]}),"\n",(0,s.jsx)(n.h2,{id:"real-change-makers",children:"Real change-makers"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Install Python 3.10.11"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"This is because to install tensorflow-cpu and DirectML the maximum supported version of python is 3.10"}),"\n",(0,s.jsxs)(n.p,{children:["Check your python version by typing ",(0,s.jsx)(n.code,{children:"python --version"})," on your command prompt, if you have other version of python then type ",(0,s.jsx)(n.code,{children:"pip list"})," in the same cmd to list your installed python packages for the user, copy them to notepad to install necessary libraries later. Now uninstall the unsupported python version and install python 3.10, ",(0,s.jsx)(n.a,{href:"https://www.python.org/downloads/release/python-31011/",children:"direct-link"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.img,{alt:"Python website (for 64bit windows)",src:i(168).A+"",width:"1400",height:"525"}),"\nPython website (for 64bit windows)"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Update CUDA Drivers"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Go to the NVIDIA GeForce Experience App and check for driver updates, if there is any new update then install it."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"If you don\u2019t have the GeForce Experience App then go to this site fill in all details, download the resultant driver, and install it with/without the GeForce Application."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.img,{alt:"NVIDIA GeForce \u2014 check for driver updates",src:i(546).A+"",width:"1400",height:"388"}),"\nNVIDIA GeForce \u2014 check for driver updates"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Install base TensorFlow library:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"pip install tensorflow-cpu==2.10"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Install tf-directml plugin"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"pip install tensorflow-directml-plugin"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Check if TensorFlow can find your GPU"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"import tensorflow as tf\ntf.config.list_physical_devices('GPU')\n# sample output -- [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU'),\n#                  PhysicalDevice(name='/physical_device:GPU:1', device_type='GPU')]\n"})}),"\n",(0,s.jsxs)(n.p,{children:["If you are getting a similar output as above, you try running a small code that utilizes GPU. Don\u2019t forget to put ",(0,s.jsx)(n.code,{children:"with tf.device('/GPU:0')"})," on the main function."]}),"\n",(0,s.jsx)(n.p,{children:"If you have a doubt about which GPU number to use, then try running with the 0 or 1 and check your task manager(ctrl+shift+esc \u2192 performance \u2192 GPU0 and GPU1) which GPU is getting utilized and use the number accordingly."})]})}function d(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},7196:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/PyTorch Start Locally-926705e61765d36712464d7769f752c9.webp"},7355:e=>{e.exports=JSON.parse('{"permalink":"/blog/tf-minimal","source":"@site/blog/2024-03-29-How_to_use_TensorFlow_with_GPU_on_Windows_for_minimal_tasks_in_the_most_simple_way_2024/story.md","title":"How to use TensorFlow with GPU on Windows for minimal tasks\u2014 in the most simple way(2024)","description":"Read on Medium","date":"2024-03-29T00:00:00.000Z","tags":[{"inline":false,"label":"TensorFlow","permalink":"/blog/tags/tensorflow","description":"TensorFlow tag description"},{"inline":false,"label":"GPU","permalink":"/blog/tags/gpu","description":"GPU tag description"}],"readingTime":3.33,"hasTruncateMarker":true,"authors":[{"name":"Ajay T Shaju","title":"AI & DS Engineer","url":"https://004ajay.github.io/","page":{"permalink":"/blog/authors/ajay"},"socials":{"linkedin":"https://www.linkedin.com/in/ajay-t-shaju/","github":"https://github.com/004ajay","medium":"https://medium.com/@ajaytshaju","x":"https://x.com/004ajayt"},"imageURL":"https://github.com/004ajay.png","key":"ajay"}],"frontMatter":{"slug":"tf-minimal","title":"How to use TensorFlow with GPU on Windows for minimal tasks\u2014 in the most simple way(2024)","authors":["ajay"],"tags":["tensorflow","gpu"]},"unlisted":false,"prevItem":{"title":"How to make a Virtual Environment in Python (Windows)","permalink":"/blog/venv-python"},"nextItem":{"title":"Building my Deep Learning project, Emotion2Emoji: Challenges and Chuckles","permalink":"/blog/emotion2emoji"}}')},7914:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/nvidia-smi command output-413a783e90200d8d526387028250123d.webp"},8453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>r});var t=i(6540);const s={},o=t.createContext(s);function a(e){const n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);