"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[9640],{1452:(e,n,a)=>{a.d(n,{A:()=>o});const o=a.p+"assets/images/Docker Process-e4325e0dcffb1043c44b61d470bdb4bb.jpg"},2112:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"commands/Docker","title":"Docker","description":"Docker Process","source":"@site/docs/commands/Docker.md","sourceDirName":"commands","slug":"/commands/Docker","permalink":"/docs/commands/Docker","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"Docker","title":"Docker","sidebar_label":"Docker"},"sidebar":"tutorialSidebar","previous":{"title":"Directory Ownership","permalink":"/docs/commands/Directory Ownership"},"next":{"title":"Fish Shell","permalink":"/docs/commands/Fish Shell"}}');var i=a(4848),r=a(8453);const s={id:"Docker",title:"Docker",sidebar_label:"Docker"},c=void 0,l={},d=[{value:"Dockerfile",id:"dockerfile",level:2},{value:"Docker Image",id:"docker-image",level:2},{value:"List all docker images",id:"list-all-docker-images",level:3},{value:"Docker image hardware usage",id:"docker-image-hardware-usage",level:3},{value:"Remove a docker image",id:"remove-a-docker-image",level:3},{value:"Recreate new image after making changes to exisitng image",id:"recreate-new-image-after-making-changes-to-exisitng-image",level:3},{value:"Zipping docker image",id:"zipping-docker-image",level:3},{value:"Load an image from Zipped file",id:"load-an-image-from-zipped-file",level:3},{value:"Docker Container",id:"docker-container",level:2},{value:"List all docker containers (with their status)",id:"list-all-docker-containers-with-their-status",level:3},{value:"Enter into the shell of a docker container",id:"enter-into-the-shell-of-a-docker-container",level:3},{value:"Remove a docker container",id:"remove-a-docker-container",level:3},{value:"Display container logs",id:"display-container-logs",level:3},{value:"Docker prune",id:"docker-prune",level:3},{value:"Docker Compose",id:"docker-compose",level:2},{value:"<code>--build</code> option in docker compose",id:"--build-option-in-docker-compose",level:3}];function t(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",hr:"hr",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Docker Process",src:a(1452).A+"",width:"1368",height:"396"})}),"\n",(0,i.jsxs)(n.p,{children:["Docker Process (from ",(0,i.jsx)(n.em,{children:(0,i.jsx)(n.a,{href:"https://www.youtube.com/watch?v=oGPjzCBZGzg",children:"https://www.youtube.com/watch?v=oGPjzCBZGzg"})}),")"]}),"\n",(0,i.jsxs)(n.p,{children:["Good videos to understand docker: ",(0,i.jsx)(n.a,{href:"https://www.youtube.com/playlist?list=PLlrv2-wV8WA1eFpbPSIcLLYqJxZSPrISZ",children:"Monis Yousuf"})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"dockerfile",children:"Dockerfile"}),"\n",(0,i.jsx)(n.p,{children:"A YAML (.yml) file for building a Docker Image. It can installs dependencies, copy your code, expose ports, and run the app"}),"\n",(0,i.jsx)(n.p,{children:"A sample dockerfile"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'version: "3.9" # Docker Compose file format version\n\nservices:\n  ollama: # "ollama" LLM Backend API Server\n    image: ollama/ollama  # Official Ollama image\n    container_name: ollama\n    ports:\n      - "11400:11434"  # Ollama API port; Map port 11400 of the host to port 11434 of the container\n    volumes:\n      - ollama_data:/root/.ollama # Persistent storage for downloaded models\n\t  \t\t\t  # \'/root/.ollama\' is the model storage location inside the container.\n    restart: unless-stopped # Automatically restart the container unless it is explicitly stopped by the user.\n    \t\t\t    # This is useful for ensuring Ollama is always running after reboots or crashes.\n\n  openwebui: # "openwebui" Web-based Frontend for LLM\n    image: ghcr.io/open-webui/open-webui:main  # Official OpenWebUI image\n    container_name: openwebui\n    ports:\n      - "3000:8080"  # Host port 3000 maps to OpenWebUI\'s internal port 8080\n    environment:\n      - OLLAMA_API_BASE_URL=http://ollama:11434  # Connect OpenWebUI to Ollama backend\n    depends_on:\n      - ollama  # Ensure Ollama starts before OpenWebUI\n    restart: unless-stopped\n\nvolumes:\n  ollama_data:  # Persistent volume for Ollama models\n'})}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"docker-image",children:"Docker Image"}),"\n",(0,i.jsx)(n.p,{children:"A read-only blueprint for making Docker Container. Think of it as a food recipe"}),"\n",(0,i.jsx)(n.h3,{id:"list-all-docker-images",children:"List all docker images"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker images\n"})}),"\n",(0,i.jsx)(n.p,{children:"Sample Output:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"REPOSITORY                      TAG       IMAGE ID       CREATED         SIZE\nghcr.io/open-webui/open-webui   main      21bb7e0892cf   2 weeks ago     4.78GB\nollama/ollama                   latest    2b23bc85a2d2   5 weeks ago     2.27GB\n"})}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(n.h3,{id:"docker-image-hardware-usage",children:"Docker image hardware usage"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker stats\n"})}),"\n",(0,i.jsx)(n.p,{children:"Sample Output:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"CONTAINER ID   NAME         CPU %    MEM USAGE / LIMIT       MEM %   NET I/O           BLOCK I/O      PIDS\n21bb7e0892cf   open-webui   0.12%    12.34MiB  /  1.953GiB   0.62%   1.23kB / 4.56kB   7.89MB / 0B    5\n"})}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(n.h3,{id:"remove-a-docker-image",children:"Remove a docker image"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo docker rmi -f <image_id>\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Example: ",(0,i.jsx)(n.code,{children:"sudo docker rmi -f ffc5b597096e"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"If an image is not removable due to some errors like"}),"\n"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Error response from daemon: conflict: unable to delete image_id (cannot be forced) - image has dependent child images"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Then use the image name with tag in the format ",(0,i.jsx)(n.code,{children:"image_name:tag"})]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Always check what the error is saying and see if it is conveying something important."}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Example: ",(0,i.jsx)(n.code,{children:"sudo docker rmi -f anaconda/conda:cpu"})]}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(n.h3,{id:"recreate-new-image-after-making-changes-to-exisitng-image",children:"Recreate new image after making changes to exisitng image"}),"\n",(0,i.jsx)(n.p,{children:"Let's say you have a container 'bd91ca3ca3c8' running, and you want to create a new image after you made changes in the container. Generating another image will allow you to preserve your changes."}),"\n",(0,i.jsx)(n.p,{children:"In that case you can run:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'docker commit -p -a "author_here" -m "your_message" bd91ca3ca3c8 name_of_new_image\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Example: ",(0,i.jsx)(n.code,{children:'docker commit -p -a "Ajay" -m "edit in frontend" bd91ca3ca3c8 OWUI_new'})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"-p"})," pauses the container while commit command is building the new image."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"-a"})," supply author information of the new image."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"-m"})," add a comment just as in the Git."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(n.h3,{id:"zipping-docker-image",children:"Zipping docker image"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker save -o <tar_filename.tar> <image_name:tag>\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Example ",(0,i.jsx)(n.code,{children:"docker save -o ollama.tar ollama/ollama:latest"})]}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(n.h3,{id:"load-an-image-from-zipped-file",children:"Load an image from Zipped file"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker load -i <name_of_archive_file_with_extension>\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Example ",(0,i.jsx)(n.code,{children:"docker load -i ollama.tar"})]}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"docker-container",children:"Docker Container"}),"\n",(0,i.jsx)(n.p,{children:"A running instance of an image. Think of it is a food made using a recipe"}),"\n",(0,i.jsx)(n.h3,{id:"list-all-docker-containers-with-their-status",children:"List all docker containers (with their status)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker ps -a\n"})}),"\n",(0,i.jsx)(n.p,{children:"Sample Output:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'CONTAINER ID   IMAGE                                COMMAND           CREATED       STATUS                 PORTS                                         NAMES\na839cf0e8ee9   ghcr.io/open-webui/open-webui:main   "bash start.sh"   3 hours ago   Up 3 hours (healthy)   0.0.0.0:3000->8080/tcp, [::]:3000->8080/tcp   open-webui\n'})}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(n.h3,{id:"enter-into-the-shell-of-a-docker-container",children:"Enter into the shell of a docker container"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo docker exec -it <container_id> /bin/bash\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Example: ",(0,i.jsx)(n.code,{children:"sudo docker exec -it ffc5b597096e /bin/bash"})]}),"\n",(0,i.jsx)(n.p,{children:"Note: There won't be any packages (like nano, vim) installed inside the shell of a docker container"}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(n.h3,{id:"remove-a-docker-container",children:"Remove a docker container"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker rm -f <container_id>\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Example: ",(0,i.jsx)(n.code,{children:"sudo docker rmi -f c22e695dfda2"})]}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(n.h3,{id:"display-container-logs",children:"Display container logs"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker logs -f $(docker ps -q -f name=<container_name>)\n\nOR\n\ndocker logs <container_name>\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Example: ",(0,i.jsx)(n.code,{children:"docker logs -f $(docker ps -q -f name=open-webui)"})," or ",(0,i.jsx)(n.code,{children:"docker logs open-webui"})]}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(n.h3,{id:"docker-prune",children:"Docker prune"}),"\n",(0,i.jsxs)(n.p,{children:["Delete all ",(0,i.jsx)(n.code,{children:"Exited"})," & ",(0,i.jsx)(n.code,{children:"Created"})," Containers"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"docker container prune -f\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"docker-compose",children:"Docker Compose"}),"\n",(0,i.jsxs)(n.p,{children:["A tool for defining and running multi-container Docker applications using a YAML file (usually docker-compose.yml, not strict, it can be ajay-compose.yml or any name [",(0,i.jsx)(n.a,{href:"https://youtu.be/BTXfR76WmCw?si=1NPzu-JUAZEEo64j&t=309",children:"see this"}),"])"]}),"\n",(0,i.jsxs)(n.p,{children:["Think like you have a dockerfile like the ",(0,i.jsx)(n.a,{href:"/docs/commands/Docker#dockerfile",children:"one above"}),"; If you make two separate dockerfiles for the Ollama and Open WebUI, you need to maintain them separately. But with docker compose, you can define them in a single file and run with a single command like ",(0,i.jsx)(n.code,{children:"docker compose up"})]}),"\n",(0,i.jsxs)(n.h3,{id:"--build-option-in-docker-compose",children:[(0,i.jsx)(n.code,{children:"--build"})," option in docker compose"]}),"\n",(0,i.jsxs)(n.p,{children:["A command like ",(0,i.jsx)(n.code,{children:"docker compose up --build"})," will rebuild new images whenever you run this command. Without the ",(0,i.jsx)(n.code,{children:"--build"}),", the docker will reuse the old image, where your new changes are not reflected."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(t,{...e})}):t(e)}},8453:(e,n,a)=>{a.d(n,{R:()=>s,x:()=>c});var o=a(6540);const i={},r=o.createContext(i);function s(e){const n=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),o.createElement(r.Provider,{value:n},e.children)}}}]);