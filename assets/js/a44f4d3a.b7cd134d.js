"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1998],{28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>a});var i=n(96540);const r={},s=i.createContext(r);function o(e){const t=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(s.Provider,{value:t},e.children)}},38030:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"gists/gpu_testing_code_tf","title":"GPU Testing Code TF","description":"Python code to check if our GPU is visible to our computer and use it in our python code using tensorflow.","source":"@site/docs/gists/gpu_testing_code_tf.md","sourceDirName":"gists","slug":"/gists/gpu_testing_code_tf","permalink":"/docs/gists/gpu_testing_code_tf","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"gpu_testing_code_tf","title":"GPU Testing Code TF","sidebar_label":"GPU Testing Code TF"},"sidebar":"tutorialSidebar","previous":{"title":"Git Commit Message","permalink":"/docs/gists/git_commit_msg"},"next":{"title":"Install Python Packages Offline (Windows)","permalink":"/docs/gists/install_py_pkgs_offline"}}');var r=n(74848),s=n(28453);const o={id:"gpu_testing_code_tf",title:"GPU Testing Code TF",sidebar_label:"GPU Testing Code TF"},a=void 0,c={},l=[];function d(e){const t={code:"code",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.p,{children:"Python code to check if our GPU is visible to our computer and use it in our python code using tensorflow."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-python",children:"import tensorflow as tf\r\nfrom tensorflow.keras.layers import Dense\r\nfrom tensorflow.keras.models import Sequential\r\nimport numpy as np\r\nimport time\r\n\r\nstart_time = time.time()\r\n\r\n# Check if TensorFlow can access the GPU\r\nprint(\"Is there a GPU available: \"),\r\nprint(tf.test.is_gpu_available())\r\n\r\nprint(\"GPU(s) available: \"),\r\nprint(tf.config.list_physical_devices('GPU'))\r\n\r\nnp.random.seed(0)\r\nX_train = np.random.rand(100, 10)\r\ny_train = np.random.randint(0, 2, (100, 1))\r\n\r\nwith tf.device('/GPU:0'): # Change this num to switch GPU\r\n    model = Sequential([\r\n        Dense(64, activation='relu', input_shape=(10,)),\r\n        Dense(64, activation='relu'),\r\n        Dense(1, activation='sigmoid')\r\n    ])\r\n\r\n    model.compile(optimizer='adam',\r\n                  loss='binary_crossentropy',\r\n                  metrics=['accuracy'])\r\n\r\n    model.fit(X_train, y_train, epochs=100)\r\n\r\nend_time = time.time()\r\ntotal_time = end_time - start_time\r\nprint(f\"Total time taken: {total_time} seconds\")\n"})})]})}function p(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);